<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Statistical inference for bacterial stability assays • StabilityToolkit</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Statistical inference for bacterial stability assays">
<meta property="og:description" content="This package contains functions to estimate plasmid cost,
    segregation rate and horizontal transfer rates from stability assays data. The
    stability asays follow periodically (usually every 24 hours) the changes in the
    fraction of plasmid free cells in serial passage cultures. At the end of each
    cycle, the experimenter takes a sample of the liquid culture and plates it after
    dilution. Using an antibiotic marker present in the plasmid, the experimenter
    can count, out of a total number of colonies plated, how many of these are
    plasmid-carrying. Here, we provide an array of statistical and mathematical
    functions to estimate the parameters of a series of dynamic models consisting
    of a pair of difference equations that follow the abundance of plasmid-free and
    plasmid-carrying cells under various biological hypotheses. The package also
    includes functions to simulate data under each model. Estimation is done via
    Maximum Likelihood. Hierarchical stochastic models are also considered. Further
    information can be found in the author papers made in collaboration with Eva
    Top, see: http://people.clas.ufl.edu/josemi/papers/">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">StabilityToolkit</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/GettingStarted.html">GettingStarted</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/javirudolph/StabilityToolkit/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="stabilitytoolkit" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#stabilitytoolkit" class="anchor"></a>StabilityToolkit</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>The goal of StabilityToolkit is to provide an array of statistical and mathematical functions to estimate parameters of a series of dynamic models consisting of a pair of difference equations that follow the abundance of plasmid-free and plasmid-carrying cells under various biological hypotheses. The package also includes functions to simulate data under each model. Estimation is done via Maximum Likelihood. Hierarchical stochastic models are also considered. Further information can be found in the author <a href="http://people.clas.ufl.edu/josemi/papers/">papers</a> made in collaboration with <a href="http://www.thetoplab.org/">Eva Top</a>.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the development version from <a href="https://github.com/">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="r"><span class="co"># install.packages("devtools")</span>
<span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">"javirudolph/StabilityToolkit"</span>)</pre></div>
<p>Once the package is installed, you can start using it by loading it with:</p>
<div class="sourceCode" id="cb2"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">StabilityToolkit</span>)</pre></div>
</div>
<div id="preamble" class="section level2">
<h2 class="hasAnchor">
<a href="#preamble" class="anchor"></a>Preamble</h2>
<p>If you have questions and run into problems, please e-mail me at <a href="mailto:josemi@ufl.edu" class="email">josemi@ufl.edu</a>. Mathematics and statistics are fantastic tools to translate fundamental questions in biology into testable predictions. It’s the best mechanism that we have in science to formulate relevant biological questions in a way that these can be directly confronted with the data sets at hand. If you have multiple tentative explanations for your results and you speak even just a little of the language of math, you have what you need to translate those tentative explanations into statistical hypotheses that can all be simultaneously tested against your data. So if you want to make the most of this package, you should familiarize yourself with the models in the <a href="http://www.thetoplab.org/">Top lab</a>. A lot of time and effort went into writing the models in a way that they are easily understood. A great place to start is the paper by <a href="https://www.genetics.org/content/168/3/1131">De Gelder et al 2004</a> and the model section of the paper by <a href="https://doi.org/10.1534/genetics.106.061937">Ponciano et al 2007</a>. There you will find all the models used in this package. Reading those papers is a pre-requisite to use this package smartly, and not just as a plug-and-play tool. Even if you don’t fully understand all of the statistical details, you won’t regret spending time on these papers. It is my hope that after reading these you will have what you need to de-bug your analyses.</p>
</div>
<div id="a-brief-description-of-what-this-package-can-do" class="section level2">
<h2 class="hasAnchor">
<a href="#a-brief-description-of-what-this-package-can-do" class="anchor"></a>A brief description of what this package can do</h2>
<p>Suppose we want to fit the segregation-selection (SS) model to estimate the plasmid cost and the segregation rate, along with the initial fraction of segregants. Given your data object name is <code>trial.data</code>, you can do this with a single line of code:</p>
<div class="sourceCode" id="cb3"><pre class="r"><span class="no">simpleSSfit</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/dynamic.fit.html">dynamic.fit</a></span>(<span class="kw">data1</span> <span class="kw">=</span> <span class="no">trial.data</span>, <span class="kw">model</span> <span class="kw">=</span> <span class="st">"SS"</span>)</pre></div>
<p>If you want to fit the Horizontal Transfer model, simply do:</p>
<div class="sourceCode" id="cb4"><pre class="r"><span class="no">simpleHTfit</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/dynamic.fit.html">dynamic.fit</a></span>(<span class="kw">data1</span><span class="kw">=</span><span class="no">trial.data</span>, <span class="kw">model</span> <span class="kw">=</span> <span class="st">"HT"</span>)</pre></div>
<p>Now, various types of biological complexities can be added to the bare bones model. For example, if you want to fit the SS model but you would like to assume that the cost parameter is negative and therefore, that carrying the plasmid is actually a benefit, then you can do that simply by modifying the default <code>true.cost</code> argument like this:</p>
<div class="sourceCode" id="cb5"><pre class="r"><span class="no">simpleSSfit</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/dynamic.fit.html">dynamic.fit</a></span>(<span class="kw">data1</span><span class="kw">=</span><span class="no">trial.data</span>,<span class="kw">model</span><span class="kw">=</span><span class="st">"SS"</span>, <span class="kw">true.cost</span><span class="kw">=</span><span class="fl">FALSE</span>)</pre></div>
<p>Here’s another type of practical thing you may want to do. Suppose you have two data sets coming from two distinct stability assays, and want to test if they are driven by the same biological parameters (same cost, segregation rate and if horizontal transfer is present, same transfer probability). Suppose that your second data set object name is <code>trial.data2</code>. If you want to do this test with the SS model, just write:</p>
<div class="sourceCode" id="cb6"><pre class="r"><span class="no">comb.SSfit</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/dynamic.fit.html">dynamic.fit</a></span>(<span class="kw">data1</span><span class="kw">=</span><span class="no">trial.data</span>,<span class="kw">model</span><span class="kw">=</span><span class="st">"SS"</span>, <span class="kw">comb</span><span class="kw">=</span><span class="fl">TRUE</span>,<span class="kw">data2</span><span class="kw">=</span><span class="no">trial.data2</span>)</pre></div>
<p>and if you want to test this idea with the Horizontal Transfer (HT) model, just type</p>
<div class="sourceCode" id="cb7"><pre class="r"><span class="no">comb.HTfit</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/dynamic.fit.html">dynamic.fit</a></span>(<span class="kw">data1</span><span class="kw">=</span><span class="no">trial.data</span>,<span class="kw">model</span><span class="kw">=</span><span class="st">"HT"</span>, <span class="kw">comb</span><span class="kw">=</span><span class="fl">TRUE</span>,<span class="kw">data2</span><span class="kw">=</span><span class="no">trial.data2</span>)</pre></div>
<p>Finally, here’s something else you may want to do. Assume you have data from a competition assay and from a stability assay and you want to leverage the information in the competition assay to better estimate the cost. This package comes with two sample data sets to that effect, one is a stability assay, called <code>data.compet</code> and another called <code>data.stabexp</code>. These two data sets come from an ancestral line, so cost is expected to be true cost. You can check out these two data sets by loading them:</p>
<div class="sourceCode" id="cb8"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">compet</span>)
<span class="no">compet</span>

<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">stabexp</span>)
<span class="no">stabexp</span></pre></div>
<p>Then, to jointly estimate the SS model parameters by using data from the competition and from the stability assay, just type</p>
<div class="sourceCode" id="cb9"><pre class="r"><span class="no">add.compet.fit</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/dynamic.fit.html">dynamic.fit</a></span>(<span class="kw">data1</span><span class="kw">=</span><span class="no">stabexp</span>,<span class="kw">model</span><span class="kw">=</span><span class="st">"SS"</span>,<span class="kw">add.compet.data</span><span class="kw">=</span><span class="fl">TRUE</span>, <span class="kw">data2</span><span class="kw">=</span><span class="no">compet</span>)</pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/javirudolph/StabilityToolkit/">https://​github.com/​javirudolph/​StabilityToolkit/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/javirudolph/StabilityToolkit/issues">https://​github.com/​javirudolph/​StabilityToolkit/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Jose Miguel Ponciano <br><small class="roles"> Author, maintainer </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Jose Miguel Ponciano.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
